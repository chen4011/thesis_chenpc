\chapter{文獻回顧}
\fontsize{12pt}{18pt}\selectfont %字體大小，行距

% ------------------------- 2.0 ------------------------- %
本論文研究主題為評估個人化模型之肌肉參數，在文獻回顧中，首先會介紹關於人體動作量測的技術，
包含動作捕捉系統、感測裝置等介紹，接續會討論關於動作模擬與分析的部分，主要切割為三部分，
前半部將先引入人體模擬流程與系統介紹，並依照複雜程度進行模型分類，後半部則是關於人體的模擬與分析資訊，
最後則會回顧個人化模型的相關文獻，統整現今學者在肌肉參數領域的研究，其針對不同方法來進行介紹，
例如以直接量測或是間接估測來取得肌肉參數。第二章節將圍繞在該研究主題的背景與現況來進行探討，最終闡述肌肉參數的重要性。

% ------------------------- 2.1 ------------------------- %
\section{動作捕捉系統}
% 概述人體動作捕捉，再說分為單感測器動作捕捉系統及多感測器動作捕捉系統，單感測動作捕捉系統又分為光學動作系統及無學動作捕捉系統
% 下面的子段落要寫的：原理、特色、目前可達到的誤差、優缺點
動作捕捉系統為現今常用於擷取人體動作、表情、手勢或其他物體動作等資訊的技術，其可應用於運動分析、醫學研究
% TODO:運動分析找找看有沒有應用的文獻，醫學研究 cite 中風後的復健應用
、遊戲開發、影片製作等領域，
藉由取得的資訊，可進行分析、模擬、辨識等應用。
根據感測器種類及數量的不同，動作捕捉系統可分為單感測器動作捕捉系統及多感測器融合動作捕捉系統，
其中單感測器動作捕捉系統又可分為光學動作捕捉系統及慣性動作捕捉系統。 

而人體姿態 (pose) 則可使用位置資訊 (position) 或朝向資訊 (orientation) 進行定義，
位置資訊通常以笛卡爾坐標系描述物體在空間中的位置，因此可使用量測結果為位置資訊的光學動作捕捉系統進行姿態追蹤；
而朝向資訊則常以尤拉角 (Euler angles) 、旋轉矩陣 (rotation matrix) 或四元數 (quaternions) 來描述物體的朝向狀態，
因此可使用量測結果為朝向資訊的慣性動作捕捉系統進行姿態追蹤。
以下將針對光學動作捕捉系統、慣性動作捕捉系統、多感測器融合動作捕捉系統，這三大類系統進行介紹。

\subsection{單感測器-光學動作捕捉系統}
% 有沒有光標記的都放在這一段裡面一起描述，可能用句號分開就好
光學動作捕捉系統是目前最常見的動作捕捉系統，其原理為透過辨別標記點或特定特徵點的位置來追蹤物體的運動，再進一步由邊際點或特徵點的位置推估物體的姿態。
根據受試者身上有無光標記 (marker)，可將光學動作捕捉系統以有無光標記的分類方法細分為光標記捕捉系統及無標記捕捉系統。

\subsubsection{光標記動作捕捉系統}
% - 量測精確度高，作為目前開發其他動作捕捉系統的標準
% - 無法在室外量測
% - 器材架設不易，價格昂貴
% - 量測誤差約落在 1 公分
光標記 (marker-based) 動作捕捉系統，
如 Vicon ~\cite{vicon_web}是目前最常見且最精準的動作捕捉系統，
其在靜態實驗中，平均絕對定位誤差為 0.15 (mm)~\cite{merriaux2017study}，
因此常被當作黃金標準，用於確認其他動作捕捉系統的準確性。
光標記動作捕捉系統所需量測設備為多個紅外光攝影機及多個反光標記點，
反光標記點需黏貼在受試者多處明顯不易被遮擋的部位，例如骨突點，確保在實驗過程中的多數時間可於影像中看見並被記錄，
而已經過校正的多個紅外光攝影機需同時記錄下影像，確保不同角度間的影像無時間差，
每台紅外光攝影機可發出紅外光，也可接收反光標記點反射的紅外光，透過三角測量計算標記點的位置來推估受試者的姿態，
實驗環境及實驗設置如圖~\ref{ch2_fig_OMC_Vicon} 所示。
由於光標記動作捕捉系統主要傳遞訊息的媒介為紅外光，需要嚴格控管環境光（例如陽光）的影響，減少環境光造成的雜訊，
因此實驗環境多為使用人造光為主要照明的的室內，無法在會受到大量陽光干擾的室外進行量測，
且由於需使用多台攝影機，因此器材架設不易，價格昂貴。

\begin{figure}[!ht]
    \centering
    \includegraphics[width=8cm]{figure/ch2_fig_OMC_Vicon.jpg}
     \caption[Vicon 實驗環境與設置]{Vicon 實驗環境與設置}
     \label{ch2_fig_OMC_Vicon}
\end{figure}

\subsubsection{無標記動作捕捉系統}
% - OpenPose、MediaPipe
    % - 看一下 OpenPose 的文獻
    % - 可在室外量測
    % - 器材架設相對容易
    % - 量測誤差約落在 7.2 公分，精準程度會隨著相機數量的減少而降低
    % - 若被遮擋，則無法辨識出被遮擋的關節
    % - 上到下或下到上的辨識（不知道找不找得到相關有提到這方面的paper）
    % - 想想看要怎麼把兩種方法的辨識結果圖片塞進去
因為光標記動作捕捉系統的限制，加上電腦視覺與深度學習的崛起，無標記 (marker-less) 動作捕捉系統逐漸受到重視~\cite{sarafianos20163d}，
其中 OpenPose ~\cite{8765346}~\cite{wei2016cpm}~\cite{simon2017hand}~\cite{cao2017realtime}、
由 Google 團隊開發的 MediaPipe ~\cite{mediapipe_web} 及由 Microsoft 開發的 Kinect ~\cite{zhang2012microsoft} 等系統是目前常見的無標記動作捕捉系統，
下方圖~\ref{ch2_fig_rec_result} 為光標記捕捉系統的實際應用。 

透過已經過校正的單一或多個攝影機同時拍攝受試者的影像，利用電腦視覺及深度學習技術辨識出受試者在二維平面上的關節點位置，
辨識關節點位置的方法分為上到下方法 (top-down method) 及下到上方法 (bottom-up method) 兩種~\cite{nie2019single}，
上到下方法如圖~\ref{ch2_fig_topvsbottom} 上半部分，
先辨識出受試者的周圍方塊 (detected bounding boxes)，再由周圍方塊內的範圍辨識出關節點位置，例如 MediaPipe 即為上到下方法，
其缺點為若在辨識過程中找不到人，無法匡出周圍方塊，則無法辨識出關節點位置，
且計算量會隨著出現在畫面中的人數增加而增加，計算時間也會隨之上升；
下到上方法如圖~\ref{ch2_fig_topvsbottom} 下半部分，
為先偵測到關節，再將關節組成群組，最後形成特定姿勢的方法，例如 OpenPose 即為下到上方法，
計算時間不會因為出現在畫面中的人數增加而增加，計算量也相對較小，
缺點為若受試者沒有完整的出現在畫面中，則有可能辨識點無法組成一個人的群組進而被判斷為一個人，
且也有可能會把非人類，但形狀與人類相似的關節點誤認，
因此，要使用哪一個系統，需經過學者們仔細思索自身需求，再進行選擇。
% 要加輸出為關鍵點還是熱圖的解釋嗎?
無論選擇哪一種辨識方法，最容易被大眾應用的相機為 RGB 相機 (Red-Green-Blue camera)，因此蒐集到的影像資訊缺乏受試者的深度資訊，
需再透過棋盤格方法~\cite{zhang1999flexible} 進行相機校正及三角測量計算，取得受試者的三維姿態。 

使用無標記動作捕捉系統進行人體姿態重建時，誤差會受到多個因素影響，
例如輸入影像辨識模型訓練集的多樣性、受試者的姿態及服裝顏色、背景複雜性、相機校正的準確度、相機的數量等，
因此誤差範圍較廣，例如 OpenPse 使用五台相機進行量測，其誤差約為 30 (mm)~\cite{nakano2020evaluation}，
Adafuse 使用八台相機進行測量，其誤差約為 19.2 (mm)~\cite{zhang2020adafuse}。
儘管無標記動作捕捉系統的誤差無法與光標記動作捕捉系統匹敵，
但是，無標記動作捕捉系統較不受環境光限制，因此可以解決實驗場地必須設置於室內的限制，可拓展至室外進行量測，也增加了可量測的範圍及動作多樣性，
且器材架設相對容易，使用手機也可進行影像錄製，架設成本相對較低，
但其缺點為易受到遮擋而影響辨識結果，若受試者的部分關節被自身遮擋或是被場域中的其他障礙物遮擋，則無法辨識出被遮擋的關節。

\begin{figure}[!ht]
    \centering
    \begin{minipage}{.5\textwidth}
      \centering
      \includegraphics[width=\linewidth]{figure/ch2_fig_rec_openpose.png}
      \caption*{(a)}
    \end{minipage}%
    \begin{minipage}{.5\textwidth}
       \centering
       \includegraphics[width=\linewidth]{figure/ch2_fig_rec_mediapipe.png}
       \caption*{(b)}
    \end{minipage}
    \caption[影像辨識結果 (a) OpenPose (b) MediaPipe]{影像辨識結果 (a) OpenPose (b) MediaPipe}
    \label{ch2_fig_rec_result}
\end{figure}

\begin{figure}[!ht]
    \centering
    \includegraphics[width=11cm]{figure/ch2_fig_topvsbottom.png}
     \caption[辨識關節點位置的方法 ~\cite{nie2019single}]{辨識關節點位置的方法 ~\cite{nie2019single}}
     \label{ch2_fig_topvsbottom}
\end{figure}

\clearpage

\subsection{單感測器-慣性動作捕捉系統}
%  - IMU
    % - 只能量測到方向，無法量測到位置
    % - 量測時常拉長後會產生 drift 的問題
以朝向為主要量測目標的慣性動作捕捉系統，通常以可穿戴的慣性感測器 (Inertial Measurement Unit, IMU) 為量測工具，
一個測量單元包括加速規 (accelerometers)、陀螺儀 (gyroscopes) 及磁力計 (magnetometers) 三種感測器，
加速規用於測量三軸加速度，陀螺儀用於測量三軸角速度，磁力計用於測量三軸磁場強度，
透過三個感測器量得重力方向及地球磁場方向，
經由資料融合演算法推估出 IMU 當下的姿態~\cite{young2009comparison}~\cite{madgwick2011estimation}~\cite{nazarahari202140}，
將 IMU 黏貼於欲量測的身體部位，例如頭部、手臂、腰部、腿等，即可量測受試者該部位的姿態。
現今最常被使用於量測人體姿態的 IMU 設備為 Xsens ~\cite{roetenberg2009xsens}~\cite{paulich2018xsens}，
其使用無線傳輸技術傳遞量測資料，並可透過其提供的軟體進行各感測器間的時間與空間校正，
進而基於骨骼結構模型重建人體姿態~\cite{mcgrath2020body}~\cite{DIP:SIGGRAPHAsia:2018}，如圖~\ref{ch2_fig_IMU_pose_estimate}所示，
更有學者進一步使用 IMU 的量測結果計算反向跳躍能力及骶骨運動學，以評估受試者的運動表現~\cite{mcginnis2016quantifying}~\cite{miranda2022accuracy}，
或是使用 IMU 進行步態分析，用於評估步態障礙患者的康復情況~\cite{wang2020imu}~\cite{uchitomi2022three}，如圖~\ref{ch2_fig_IMU_gait_estimate} 所示。

IMU 為一種微機電系統 (micro-electromechanical systems, MEMS) 感測器，
其功率消耗低、體積小、重量輕、攜帶方便，因此可量測場域廣泛，不受空間限制，可以作為日常配戴的裝置，時刻監測受試者的姿態；
且其可克服在無標記動作捕捉系統中的遮擋問題，及運動速度過快產生的模糊問題。
但是，IMU 僅可量測方向，無法量測位置，且隨著量測時間拉長，
將加速度進行積分後會產生嚴重的飄移問題 (drift)，從而無法計算位置資訊；
且每次測量皆需校正每一感測器與其黏貼的身體部位的相對位置及相對方向，以確保量測結果的準確性，
在量測過程中，IMU 可能會因為肌肉出力與放鬆而有相對位置的變化，
進而影響量測結果的準確性~\cite{fiorentino2017soft}~\cite{stagni2005quantification}。

\begin{figure}[!ht]
    \centering
    \includegraphics[width=\linewidth]{figure/ch2_fig_IMU_pose_estimate.png}
     \caption[使用 IMU 重建人體姿態]{使用 IMU 重建人體姿態}
     \label{ch2_fig_IMU_pose_estimate}
\end{figure}

\begin{figure}[!ht]
    \centering
    \includegraphics[width=\linewidth]{figure/ch2_fig_IMU_gait_estimate.png}
     \caption[使用 IMU 進行步態分析]{使用 IMU 進行步態分析}
     \label{ch2_fig_IMU_gait_estimate}
\end{figure}

\subsection{多感測器融合動作捕捉系統}
% - 相機與 IMU 融合
% - 3DPW、totalcapture、real-time full-body…、wearable fusing…
由於無標記光學動作捕捉系統會因為遮擋問題而無法辨識出被遮擋的關節，IMU 量測時長拉長會產生飄移問題，
因此，學者們開始將光學動作捕捉系統與 IMU 進行融合，以彌補各自的缺點~\cite{li2023visual}，
藉由 IMU 的量測資料補足光學動作捕捉系統的遮擋、移動快速產生模糊的問題，
並藉由光學動作捕捉系統不受磁場影響的特性，解決 IMU 量測時長拉長產生飄移的問題，同時可用於計算受試者於空間中的位置資訊。

多感測器融合方法可應用於自動駕駛、智慧機器人、增強實境 (AR) 及虛擬實境 (VR) 等領域~\cite{jinyu2019survey}~\cite{zhu2023camera}，
也可應用於人體動作捕捉領域，人體動作捕捉範圍可包含手部、上半身、下半身、全身等不同部位，
例如 Trumble Matt 等人使用 4 或 8 台相機及 13 個 IMU 進行融合，建立人體全身姿態，
並發表一系列經過時間對齊的多視角影片 (multi-viewpoint video, MVV) 搭配 IMU 資料集~\cite{Trumble:BMVC:2017}；
或如學者 Zhang Zhe 等人使用 TotalCapture 資料集中的 4 台攝影機，及 8 個 IMU 資料融合，
並使用同資料集的 Vicon 資料驗證融合方法，誤差為 24.6 (mm) ~\cite{zhang2020fusing}；
又如學者 Von Marcard 等人提出的 3DPW ~\cite{Marcard_2018_ECCV}，
使用一台手持式可移動相機及 6 \textasciitilde\ 17 個 IMU 融合重建人體在戶外運動的姿態，如圖~\ref{ch2_fig_3DPW} 所示，
使用 TotalCapture 資料集驗證融合方法，誤差為 26 (mm)，並發表一系列可供下載的資料集。
% TODO:想加上下半身的研究
相機及 IMU 使用數量可有多種組合，端看學者們的需求及實驗設計。

\begin{figure}[!ht]
    \centering
    \includegraphics[width=\linewidth]{figure/ch2_fig_3DPW.png}
     \caption[多感測器融合建立人體姿態]{多感測器融合建立人體姿態}
     \label{ch2_fig_3DPW}
\end{figure}

% ------------------------- 2.2 ------------------------- %
\section{個人化人體模型}
% 個人化骨架，還沒頭緒要寫什麼
% - 可能可以提及前人的做法，例如使用 Vicon 作為骨架，但是這樣的骨架不夠個人化，所以我要做這些事情
使用動作捕捉系統重新建立人體姿態後，常會使用人體模型 (human body model) 來描述與表示受試者的姿態，
人體模型可用於描述人體結構、人體形狀及人體表面紋理等資訊~\cite{gong2016human}。
依照模型包含的資訊不同，人體模型可分為運動學模型 (Kinematic model)、平面模型 (Planar Model)、體積模型 (Volumetric Model) 三類，
如圖~\ref{ch2_fig_personal_model}所示。

\begin{figure}[!ht]
    \centering
    \includegraphics[width=\linewidth]{figure/ch2_fig_personal_model.png}
     \caption[三種不同的人體模型 (a) 運動學模型 (b) 平面模型 (c) 體積模型]{三種不同的人體模型 (a) 運動學模型 (b) 平面模型 (c) 體積模型}
     \label{ch2_fig_personal_model}
\end{figure}

% TODO:下面三種模型舉例，體積模型的敘述還沒寫完
\subsection{運動學模型}
運動學模型是最常見且最頻繁被應用的模型，可用於描述二維或三維人體姿態，
通常只考慮人體骨架結構，不考慮人體的肌肉組織，以點描述關節位置，並以棍子連接關節，代表人體指定肢體的骨骼方向，
因此運動學模型可以淺顯易懂的方式描述人體部位間的關係，但無法描述人體的形狀及表面紋理。

運動學模型可分為兩類，一類為預定義模型 (predefined model)，另一類為學習圖像結構模型 (learned graph structure model)。
預定義模型結構為基於人體解剖學與物理定義所建構，其關節點名稱、層級與父子關係皆有既定定義，
不受動作捕捉數據影響，不涉及任何機器學習過程，例如 Vicon 系統中的骨架結構。
除 Vicon 系統的骨架結構外，也有學者使用預定義模型描述人體姿態估計，例如 DeepPose ~\cite{Toshev_2014_CVPR}，
或是基於預定義模型進行機器學習，以約束結果符合人體結構~\cite{wei2016convolutional}。
預定義模型具有明確的物理意義，且易於解釋，但模型結構較為簡化，因此無法捕捉複雜且具有細節的運動模式。

學習圖像結構模型則從大量的人體運動圖像數據中學習人體的結構，從而建構起人體的模型，
學習圖像結構模型的方法十分多樣，一種最為常見的模型為圖像結構模型 (Pictorial Structure Models, PSM)~\cite{johnson2010clustered}，
學習圖像模型可以捕捉複雜的運動模式，具有較好的人體描述能力，且模型可從數據中學習到更多的特徵，減少人工設計的成分，
但模型結構較為複雜，且可能缺乏明確的物理意義，因此難以解釋。
% TODO:上圖

\subsection{平面模型}
平面模型則是將人體分割成多個平面，以平面描述人體的外觀及形狀，身體各部位由與人體部位相似的矩形組成，可被用於描述二維人體姿態，

\subsection{體積模型}
體積模型包括人體的形狀資訊，人體部位由相似形狀的圓柱體或圓錐體描述，人體表面由數千個網格組成，
可被用於描述三維人體姿態，模型的樣貌最接近人體型態，

% ------------------------- 2.3 ------------------------- %
\section{時間對齊}
% 時間對齊的重要性
感測器間皆有各自的計時器及採樣頻率，因此無論是使用同類型感測器或是使用並融合不同類型的感測器，皆需考慮使用的資料點是否位於相同的時刻，
若資料點不在相同時刻，則需進行時間對齊 (time synchronization) 的處理，以確保資料點的一致性。
最常見的時間對齊方法，一為使用硬體觸發器，透過硬體觸發器同時觸發所有感測器進行採樣，確保所有感測器的資料點位於相同時刻；
二為使用預先定義的動作進行時間對齊，
例如使用拍手動作，透過拍手發出的聲音進行影像間的時間對齊，
再透過拍手時巨大的加速度變化進行 IMU 與影像間的時間對齊~\cite{pons2012data}；
或是使用垂直跳躍或跺腳等動作，透過動作開始的時間點進行影像對齊，
再透過動作中的加速度變化對齊 IMU 與影像的時間~\cite{destelle2014low}~\cite{Trumble:BMVC:2017}；
抑是直接使用受試者的動作進行時間對齊，例如直接尋找影像中受試者走路時腳與地面接觸的時間點，
在影像方面，可以直接從影像辨識到的踝關節運動進行推測，
在 IMU 方面，可透過貼於腳上的 IMU 的加速度測量值中計算出腳與地面接觸的時間點~\cite{kaichi2020resolving}；
也可使用 LED 燈及遠紅外光 LED 燈進行時間對齊，透過 LED 燈的閃爍進行影像間的時間對齊~\cite{nakano2020evaluation}~\cite{needham2021accuracy}。
上述之時間對齊方法，皆有對應適合的感測器，因此在選擇時間對齊方法時，需依照研究需求進行選擇。

% ------------------------- 2.4 ------------------------- %
\section{感測器融合演算法}
% 感測器融合演算法
感測器融合演算法，還沒頭緒要寫什麼

% ------------------------- 2.5 ------------------------- %
\section{小結}
描述目前文獻不足的地方，所以我要做這些事情
我的部分可能就是描述目前使用的文獻都是使用 Vicon 作為骨架，我想要改善這一點，還有資料對其的地方，要再思考這不分要如何在前面2.3的章節先提到，而且可以承接章節2.2

- 骨架
- 時間對齊

% 章節回顧；個人化模型必要
本章節回顧了與研究主題相關的論文，首先從最基礎的量測技術開始介紹，
像是動作捕捉系統、力感測裝置與 EMG 等常見的量測方法，這些儀器能夠量化人體的動作表現，
透過數據處理針對特定主題來深入探討，亦可作為模擬的輸入或是輸出的驗證比較，其中量測的精準度將對應用有大幅影響，
因此在校正量測結果或是提高估計準確度上皆是重要的議題；接續介紹關於人體動作模擬的工作流程、系統、模型，
以及相關的研究文獻，研究探討不再僅限於臨床實驗當中，另外像是肌肉力量、關節扭矩等這些難以量測的資訊，
皆可在電腦中快速地取得，獲取資訊的種類增加意味著能探討的問題更加多元，大幅增廣在生物力學上的觀點；
最後針對個人化模型議題進行更深入的調查，模型準確度代表著與受試者是否有密切關聯，若僅透過通用模型進行研究，
模擬結果將與實際情況有所落差，而個人化模型能對所感興趣的資訊更真實的呈現，
因此根據不同受試者來建立對應的個人化模型是必要的。

% 重述困境；誤差是否可接受；肌肉代償；參數抗衡
個人化模型的建立將會複雜許多，以肌肉參數為例，除了參數取得不易外，還有可能會發生肌肉代償問題，
而在同一條肌肉的參數間，其亦具有參數不可識別性，在運動軌跡預測作為驗證的文獻中，
於比較軌跡的圖形裡 (文獻 Fig. 6)，這個量級的誤差是否為可接受的？在肌肉代償與參數間會互相抗衡的情況下，
微小的誤差就會造成參數的估計錯誤，若誤差大到一定程度，其評估效果也將不及通用模型，
故在估計與驗證參數的過程是十分重要的。

% 論文重點；章節安排
本論文著重在肌肉參數的估計中，對於上述的問題進行深入探討與驗證，提出一套適用的估計參數研究方法，
並以已建立好的上肢模型作為驗證，除了進行參數估計外，也會呈現參數間抗衡的範例，來顯現該問題的重要性。

\clearpage